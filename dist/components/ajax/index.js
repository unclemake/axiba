define("components/ajax/index.js",function(require, exports, module) {
"use strict";function get(e,t,r){return exports.ajax(e,t,r,"get")}function post(e,t,r){return exports.ajax(e,t,r,"post")}function put(e,t,r){return exports.ajax(e,t,r,"put")}function del(e,t,r){return exports.ajax(e,t,r,"delete")}var __awaiter=function(e,t,r,n){return new(r||(r=Promise))(function(a,u){function o(e){try{s(n.next(e))}catch(e){u(e)}}function i(e){try{s(n.throw(e))}catch(e){u(e)}}function s(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(o,i)}s((n=n.apply(e,t)).next())})},superagent=require("superagent"),index_1=require("../notification/index"),config_1=require("../global/config");exports.get=get,exports.post=post,exports.put=put,exports.del=del;var ajaxRecordArray=[],stTime=400,typeFunctionArray=[function(e,t,r,n,a){var u=ajaxRecordArray.find(function(r){return r!=a&&r.url===e&&r.data===t&&r.ajaxType===n&&a.time.getTime()-r.time.getTime()<400});if(u)return ajaxRecordArray=ajaxRecordArray.filter(function(e){return e!=a}),new Promise(function(){})},function(e,t,r,n,a){return new Promise(function(r,u){var o=ajaxRecordArray.find(function(r){return r!=a&&r.url===e&&r.data===t&&r.ajaxType===n});if(o){if(ajaxRecordArray=ajaxRecordArray.filter(function(e){return e!=a}),o.responseDate)return r(o.responseDate);o.response.on("end",function(){r(o.responseDate)})}r()})},function(e,t,r,n,a){return new Promise(function(r,u){var o=ajaxRecordArray.find(function(r){return r!=a&&r.url===e&&r.data===t&&r.ajaxType===n&&a.time.getTime()-r.time.getTime()<400});o&&clearTimeout(o.setTimeout),a.setTimeout=setTimeout(function(){r()},stTime)})}];exports.ajax=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"get";return __awaiter(void 0,void 0,void 0,regeneratorRuntime.mark(function a(){var u,o,i,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:0!=e.indexOf("http")&&(e=config_1.ajax.requestUrl+e),u=void 0,o={url:e,time:new Date,data:t,type:r,ajaxType:n},a.t0=n,a.next="delete"===a.t0?6:"put"===a.t0?8:"get"===a.t0?10:"post"===a.t0?12:14;break;case 6:return u=superagent.delete(e),a.abrupt("break",14);case 8:return u=superagent.put(e),a.abrupt("break",14);case 10:return u=superagent.get(e),a.abrupt("break",14);case 12:return u=superagent.post(e),a.abrupt("break",14);case 14:return t&&(u=u.send(t)),ajaxRecordArray.unshift(o),a.next=18,typeFunctionArray[r](e,t,r,n,o);case 18:if(i=a.sent,!i){a.next=21;break}return a.abrupt("return",i);case 21:return s=function(e,t){u.end(function(r,n){if(o.response=n,r)index_1.error({message:"请求错误!",description:"status:${res.status}"}),t(o.responseDate);else{try{o.responseDate=JSON.parse(n.text)}catch(e){o.responseDate={status:0,data:n.text,message:""}}e(o.responseDate)}})},a.abrupt("return",new Promise(s));case 23:case"end":return a.stop()}},a,this)}))};
});