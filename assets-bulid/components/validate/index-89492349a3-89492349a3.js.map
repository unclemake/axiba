{"version":3,"sources":["components/validate/index.js","components/validate/index.tsx"],"names":["React","require","index_1","rule_1","exports","addRule","getLength","index_2","Validate","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","apply","arguments","state","msg","validate","value","props","e","target","replaceDefault","required","valueValidateSave","setState","hiddenPopover","valueValidate","key","messages","hasOwnProperty","valueReplace","_this2","clearTimeout","hiddenST","setTimeout","replaceFunction","replaceArray","createElement","map","index","type","parameter","rule","ruleArray","ruleDefault","push","default","overlayClassName","placement","content","msgRender","visible","onChange","bind","onBlur","Component","defineProperty"],"mappings":";AAAA,43BCAYA,MAAKC,QAAM,SACvBC,QAAAD,QAAkB,kBAClBE,OAAAF,QAA8H,SAsQrHG,SAAAC,QAAOF,OAAAE,QAAED,QAAAE,UAASH,OAAAG,SArQ3B,IAAAC,SAAAN,QAAoB,oBAqGpBO,qBAAA,QAAAA,KAAAC,gBAAAC,KAAAF,EAAA,IAAAG,GAAAC,2BAAAF,MAAAF,EAAAK,WAAAC,OAAAC,eAAAP,IAAAQ,MAAAN,KAAuBO,WAAvB,OAOIN,GAAAO,OACIC,OACAC,UAAU,EACVC,MAAOV,EAAKW,MAAMD,OAV1BV,yEAsBqBY,GACb,GAAIF,GAAQE,EAAEC,OAAOH,MACjBH,EAAQR,KAAKQ,KAMjB,IALAA,EAAMC,OACND,EAAME,UAAW,EAEjBF,EAAMG,MAAQlB,OAAAsB,eAAeJ,GAEzBX,KAAKY,MAAMI,SAAU,CACrB,GAAIN,GAAWV,KAAKiB,kBAAkB,WAAYN,EAGlD,IAFAX,KAAKkB,SAASlB,KAAKQ,OACnBR,KAAKmB,iBACAT,EAAY,WACd,CACH,GAAIA,GAAWV,KAAKoB,cAAc,WAAYT,EAC9C,KAAKD,EAAY,OAGrB,IAAK,GAAIW,KAAOrB,MAAKY,MACjB,GAAInB,OAAA6B,SAASC,eAAeF,GAAM,CAC9Bb,EAAMG,MAAQX,KAAKwB,aAAaH,EAAKV,EACtBX,MAAKiB,kBAAkBI,EAAKV,GAInDX,KAAKkB,SAASlB,KAAKQ,OACnBR,KAAKmB,wDAWY,GAAAM,GAAAzB,IACjB0B,cAAa1B,KAAK2B,UAClB3B,KAAK2B,SAAWC,WAAW,WACvBH,EAAKjB,MAAME,UAAW,EACtBe,EAAKP,SAASO,EAAKjB,QACpB,2CAcca,EAAKV,GACtB,GAAIkB,GAAkBpC,OAAAqC,aAAaT,EACnC,OAAIQ,GACOA,EAAgBlB,GAEhBA,sCAYX,MAAOrB,OAAAyC,cAAA,MAAI,KACP/B,KAAKQ,MAAMC,IAAIuB,IAAI,SAACrB,EAAOsB,GAAR,MAAkB3C,OAAAyC,cAAA,KAAGV,IAAKY,GAAQtB,4CAavCuB,EAAcvB,GAChC,GACIwB,IADQnC,KAAKQ,MACDR,KAAKY,MAAMsB,IACvBE,EAAO3C,OAAA4C,UAAUH,IAASzC,OAAA6C,YAAYJ,GACtCxB,EAAW0B,EAAKzB,EAAOwB,EAC3B,OAAOzB,6CAYOwB,EAAcvB,GAC5B,GAAIH,GAAQR,KAAKQ,MACbC,EAAMhB,OAAA6B,SAASY,GACfC,EAAYnC,KAAKY,MAAMsB,GACvBxB,EAAWV,KAAKoB,cAAcc,EAAMvB,EAGxC,OAFAH,GAAME,SAAWF,EAAME,UAAYA,EACnCA,GAAYF,EAAMC,IAAI8B,KAAK9B,EAAIE,EAAOwB,IAC/BzB,mCAGMG,GACbb,KAAKQ,MAAMG,MAAQE,EAAEC,OAAOH,MAC5BX,KAAKkB,SAASlB,KAAKQ,wCAULR,KAATY,KACL,OAAQtB,OAAAyC,cAAClC,QAAA2C,SAAQC,iBAAiB,sBAAsBC,UAAU,UAAUC,QAAS3C,KAAK4C,YAAaC,SAAU7C,KAAKQ,MAAME,UAEpHpB,MAAAyC,cAACvC,QAAAgD,SAAM7B,MAAOX,KAAKQ,MAAMG,MACrBmC,SAAU9C,KAAK8C,SAASC,KAAK/C,MAC7BgD,OAAQhD,KAAKU,SAASqC,KAAK/C,gBAzJxBV,MAAM2D,UAiK7B7C,QAAA8C,eAAAxD,QAAA,cAAAiB,OAAA,IAnDQjB,QAAA8C,QAmDO1C","file":"components/validate/index.js","sourcesContent":["\"use strict\";\nconst React = require('react');\nconst index_1 = require('../input/index');\nconst rule_1 = require('./rule');\nexports.addRule = rule_1.addRule;\nexports.getLength = rule_1.getLength;\nconst index_2 = require('../popover/index');\n;\n;\n/**\n * 验证类\n *\n * @class Validate\n * @extends {React.Component<IValidateProps, IValidateState>}\n */\nclass Validate extends React.Component {\n    constructor() {\n        super(...arguments);\n        /**\n         * 状态\n         *\n         * @memberOf Validate\n         */\n        this.state = {\n            msg: [],\n            validate: true,\n            value: this.props.value\n        };\n    }\n    /**\n     * 验证事件\n     *\n     * @private\n     * @param {any} e\n     * @returns\n     *\n     * @memberOf Validate\n     */\n    validate(e) {\n        let value = e.target.value;\n        let state = this.state;\n        state.msg = [];\n        state.validate = true;\n        //去除前后空格\n        state.value = rule_1.replaceDefault(value);\n        if (this.props.required) {\n            let validate = this.valueValidateSave('required', value);\n            this.setState(this.state);\n            this.hiddenPopover();\n            if (!validate) {\n                return;\n            }\n        }\n        else {\n            let validate = this.valueValidate('required', value);\n            if (!validate) {\n                return;\n            }\n        }\n        for (let key in this.props) {\n            if (rule_1.messages.hasOwnProperty(key)) {\n                state.value = this.valueReplace(key, value);\n                let validate = this.valueValidateSave(key, value);\n            }\n        }\n        this.setState(this.state);\n        this.hiddenPopover();\n    }\n    /**\n     * 定时隐藏提示框\n     *\n     * @private\n     *\n     * @memberOf Validate\n     */\n    hiddenPopover() {\n        clearTimeout(this.hiddenST);\n        this.hiddenST = setTimeout(() => {\n            this.state.validate = true;\n            this.setState(this.state);\n        }, 4500);\n    }\n    /**\n     * 输入值 替换\n     *\n     * @private\n     * @param {any} key\n     * @param {any} value\n     * @returns\n     *\n     * @memberOf Validate\n     */\n    valueReplace(key, value) {\n        let replaceFunction = rule_1.replaceArray[key];\n        if (replaceFunction) {\n            return replaceFunction(value);\n        }\n        else {\n            return value;\n        }\n    }\n    /**\n     * 验证信息渲染\n     *\n     * @returns\n     *\n     * @memberOf Validate\n     */\n    msgRender() {\n        return React.createElement(\"div\", null, this.state.msg.map((value, index) => React.createElement(\"p\", {key: index}, value)));\n    }\n    /**\n     * 验证\n     *\n     * @param {string} type 验证类型\n     * @param {string} value 验证值\n     * @returns\n     *\n     * @memberOf Validate\n     */\n    valueValidate(type, value) {\n        let state = this.state, parameter = this.props[type], rule = rule_1.ruleArray[type] || rule_1.ruleDefault(type), validate = rule(value, parameter);\n        return validate;\n    }\n    /**\n     * 验证 --> 保存验证\n     *\n     * @param {string} type\n     * @param {string} value\n     * @returns\n     *\n     * @memberOf Validate\n     */\n    valueValidateSave(type, value) {\n        let state = this.state, msg = rule_1.messages[type], parameter = this.props[type], validate = this.valueValidate(type, value);\n        state.validate = state.validate && validate;\n        validate || state.msg.push(msg(value, parameter));\n        return validate;\n    }\n    onChange(e) {\n        this.state.value = e.target.value;\n        this.setState(this.state);\n    }\n    /**\n     * 渲染\n     *\n     * @returns {JSX.Element}\n     *\n     * @memberOf Validate\n     */\n    render() {\n        let { props } = this;\n        return (React.createElement(index_2.default, {overlayClassName: 'ant-popover-warning', placement: \"topLeft\", content: this.msgRender(), visible: !this.state.validate}, React.createElement(index_1.default, {value: this.state.value, onChange: this.onChange.bind(this), onBlur: this.validate.bind(this)})));\n    }\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Validate;",null],"sourceRoot":"/assets"}